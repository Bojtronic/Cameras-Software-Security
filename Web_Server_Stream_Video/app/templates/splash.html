<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Iniciando...</title>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">

    <style>
        body {
            margin: 0;
            height: 100vh;
            background: radial-gradient(circle at top, #0f172a, #020617);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: system-ui, -apple-system, BlinkMacSystemFont;
            color: #e5e7eb;
        }

        .splash {
            text-align: center;
            width: 320px;
        }

        /* TEXTO SUPERIOR */
        .brand {
            font-size: 1.4rem;
            font-weight: 700;
            letter-spacing: 0.15em;
            margin-bottom: 20px;
            transition: color 0.5s ease;
        }

        .logo {
            width: 96px;
            margin-bottom: 20px;
            transition: opacity 0.4s ease;
        }

        .subtitle {
            font-size: 1.1rem;
            margin-bottom: 25px;
            font-weight: 500;
        }

        .progress {
            width: 100%;
            height: 6px;
            background: #1e293b;
            border-radius: 999px;
            overflow: hidden;
        }

        .bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #22d3ee, #3b82f6);
            animation: loading 2s infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 80%; }
            100% { width: 100%; }
        }

        .status {
            margin-top: 15px;
            font-size: 0.85rem;
            opacity: 0.7;
        }
    </style>
</head>

<body>

<div class="splash">

    <!-- TEXTO CAMBIANTE -->
    <div id="brand" class="brand">SECURITY SOFTWARE</div>

    <!-- ICONO -->
    <img id="logo" src="/static/icono1.png" class="logo">

    <div class="subtitle">Iniciando sistema de monitoreo IAâ€¦</div>

    <div class="progress">
        <div class="bar"></div>
    </div>

    <div class="status" id="status">Cargando serviciosâ€¦</div>
</div>

<script>
    const icons = [
        "/static/icono1.png",
        "/static/icono2.png"
    ];

    const colors = [
        "#38bdf8",  // azul claro
        "#22d3ee" // cian
        
    ];

    let iconIndex = 0;
    let serverReady = false;
    const startTime = Date.now();
    const MIN_TIME = 6000; // 6 segundos

    // ðŸ” Icono + color cada 2s
    setInterval(() => {
        const logo = document.getElementById("logo");
        const brand = document.getElementById("brand");

        logo.style.opacity = 0;

        setTimeout(() => {
            iconIndex = (iconIndex + 1) % icons.length;
            logo.src = icons[iconIndex];
            logo.style.opacity = 1;

            brand.style.color = colors[iconIndex % colors.length];
        }, 400);

    }, 2000);

    // â¤ï¸ Health check
    async function checkServer() {
        try {
            const res = await fetch("/health", { cache: "no-store" });
            if (res.ok) serverReady = true;
        } catch (e) {}
    }

    setInterval(checkServer, 800);

    // ðŸš¦ Salida controlada
    setInterval(() => {
        const elapsed = Date.now() - startTime;
        if (serverReady && elapsed >= MIN_TIME) {
            window.location.href = "/";
        }
    }, 500);
</script>

</body>
</html>
